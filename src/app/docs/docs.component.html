<mat-toolbar fxLayout fxLayoutGap="1em">
  <button mat-icon-button (click)="drawer.toggle()">
    <mat-icon>menu</mat-icon>
  </button>
  <h1 routerLink="/">GitHub Issues</h1>
  <mat-form-field appearance="outline" floatLabel="never">
    <input #repobox type="text" matInput placeholder="user/repository" [(ngModel)]="repo">
    <button [hidden]="repobox.value" mat-button matSuffix mat-icon-button aria-label="Clear filter"
      matTooltip="Clear filter" (click)="clearInput(repobox)">
      <mat-icon>close</mat-icon>
    </button>
  </mat-form-field>
  <button mat-raised-button color="primary" aria-label="Search icon button" (click)="fetchGithubIssues()">
    Search issues
  </button>
</mat-toolbar>

<mat-divider></mat-divider>

<mat-drawer-container autosize class="remaining-height">
  <mat-drawer #drawer mode="side" opened="true" class="fixed-width">
    <mat-selection-list #labelsList [multiple]="false">
      <mat-list-option *ngFor="let state of states" [value]="state.name" [matTooltip]="state.name">
        <mat-icon mat-list-icon>{{state.icon}}</mat-icon>
        {{ state.name | titlecase}}
      </mat-list-option>
    </mat-selection-list>
  </mat-drawer>


  <!-- <smc-simplemattable
    [data]="data"
    [columns]="columns"
    [paginator]="true"
    [paginatorLength]="paginatorLength"
    [backendPagination]="true"
    [loading]="loading"
    (page)="refresh($event)"
    [rowClickable]="true"
    (rowClick)="viewDoc($event)">
  </smc-simplemattable> -->


  <div>
    <mat-paginator [length]="resultsLength" pageSize="10" hidePageSize></mat-paginator>
    <div class="example-loading-shade" *ngIf="isLoadingResults || isRateLimitReached">
      <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
      <div class="example-rate-limit-reached" *ngIf="isRateLimitReached">
        GitHub's API rate limit has been reached. It will be reset in one minute.
      </div>
    </div>
    <div class="example-table-container" [ngStyle]="{'opacity': isLoadingResults ? '0.5' : '1'}">
      <table mat-table [dataSource]="dataSource" class="example-table" matSort matSortActive="created"
        matSortDisableClear matSortDirection="desc">
        <ng-container matColumnDef="select" class="checkbox-column">
          <th mat-mat-toolbar-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
              [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()"
              matTooltip="Select">
            </mat-checkbox>
          </th>
          <td mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)" matTooltip="Select">
            </mat-checkbox>
          </td>
        </ng-container>
        <ng-container matColumnDef="number">
          <th mat-mat-toolbar-cell *matHeaderCellDef>Issue #</th>
          <td mat-cell *matCellDef="let row" class="issue-number-column">{{row.number}}</td>
        </ng-container>
        <ng-container matColumnDef="title">
          <th mat-mat-toolbar-cell *matHeaderCellDef>Title</th>
          <td mat-cell *matCellDef="let row">
            <div fxLayout fxLayoutAlign="start center" fxLayoutGap="0.4em">
              <mat-chip-list aria-label="Issue state">
                <mat-chip>{{ row.state }}</mat-chip>
              </mat-chip-list>
              <span>{{row.title}}</span>
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="created" [stickyEnd]="true">
          <th mat-mat-toolbar-cell *matHeaderCellDef mat-sort-mat-toolbar disableClear>Created</th>
          <td mat-cell *matCellDef="let row" class="last-column">
            <span [style.display]="!row.hovered ? 'block' : 'none'">{{row.created_at | date}}</span>
            <mat-chip-list [style.display]="row.hovered ? 'block' : 'none'" aria-label="View issue">
              <mat-chip class="gmail-action" (click)="openInNew(row.html_url)">
                <span>View issue</span>
                <mat-icon class="icon-display">call_made</mat-icon>
              </mat-chip>
              <button *ngFor="let action of actions" mat-icon-button [attr.aria-label]="action.name | titlecase"
                [matTooltip]="action.name | titlecase" class="action-button" (click)="action.method(row, action)">
                <mat-icon>{{action.icon}}</mat-icon>
              </button>
            </mat-chip-list>
          </td>
        </ng-container>
        <tr mat-mat-toolbar-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; let i = index; columns: displayedColumns;"
          class="example-element-row remove-background" [ngClass]="{'mat-elevation-z2': row.hovered}"
          (mouseover)="handleMouseOver(row)" (mouseout)="handleMouseLeave(row)">
        </tr>
      </table>
    </div>
  </div>

  <pre>{{ dataSource?.data | json }}</pre>


</mat-drawer-container>
